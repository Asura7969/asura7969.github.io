<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Asura7969 Blog</title><meta name="keywords" content="java,bigdata"><meta name="author" content="Asura7969"><meta name="copyright" content="Asura7969"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="Asura7969 Blog">
<meta property="og:url" content="https://asura7969.github.io/page/3/index.html">
<meta property="og:site_name" content="Asura7969 Blog">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://asura7969.github.io/img/shanyi.jpg">
<meta property="article:author" content="Asura7969">
<meta property="article:tag" content="java,bigdata">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://asura7969.github.io/img/shanyi.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://asura7969.github.io/page/3/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Asura7969 Blog',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2022-12-10 00:14:58'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/shanyi.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">38</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/img/hexobackground.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Asura7969 Blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Asura7969 Blog</h1><div id="site_social_icons"><a class="social-icon" href="https://github.com/Asura7969" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1402357969@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/03/06/Flink%20Stream%E6%96%87%E4%BB%B6%E5%8E%8B%E7%BC%A9%E8%AF%91%E6%96%87/" title="Flink Stream文件压缩译文">     <img class="post_bg" src="/img/topimg/202105161053.png" onerror="this.onerror=null;this.src='/img/404-b.jpg'" alt="Flink Stream文件压缩译文"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/03/06/Flink%20Stream%E6%96%87%E4%BB%B6%E5%8E%8B%E7%BC%A9%E8%AF%91%E6%96%87/" title="Flink Stream文件压缩译文">Flink Stream文件压缩译文</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-03-06T09:05:09.000Z" title="发表于 2021-03-06 17:05:09">2021-03-06</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%AF%91%E6%96%87/">译文</a></span></div><div class="content">背景用户经常抱怨写了许多小文件。 小文件将影响文件读取和DFS系统的性能，甚至会影响DFS系统的稳定性。
目标：
压缩这个job 单次checkpoint产生的所有文件
通过压缩，用户可以设置更小的检查点间隔，甚至可以减少到秒级。

场景：在checkpoint 间隔内，task不能写足够大的文件

第一种情况：分区策略不仅涉及时间，而且还可能包括业务关键字段，例如applicationId。对于具有大量数据的分区，它可以写出所需的文件大小；但是，某些分区的数据量很小，并且无法生成足够大的文件，因此需要进行压缩。
第二种情况：流作业中存在数据高峰和低谷，但是接收器的并行性是相同的。 在低谷状态时，将出现较少的数据，并且无法在检查点间隔内写入所需的文件大小。

未满足的场景：
每个task持续从上游接收数据。 每个task都可以填满CPU /资源。 然后将检查点间隔设置得太小，从而导致大量文件产生。 这时，压缩器无法在这么小的检查点延迟中完成压缩：
一般来说，除非检查点间隔太小，否则不会发生这种情况（测试后，parquet格式文件可以在1秒内写入10MB，也就是说，它可以在12秒内写入足 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2021/03/04/Flink%20Checkpoint%E6%81%A2%E5%A4%8D%E6%B5%81%E7%A8%8B/" title="Flink Checkpoint 恢复流程">     <img class="post_bg" src="/img/topimg/202105161039.png" onerror="this.onerror=null;this.src='/img/404-b.jpg'" alt="Flink Checkpoint 恢复流程"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/03/04/Flink%20Checkpoint%E6%81%A2%E5%A4%8D%E6%B5%81%E7%A8%8B/" title="Flink Checkpoint 恢复流程">Flink Checkpoint 恢复流程</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-03-04T00:31:57.000Z" title="发表于 2021-03-04 08:31:57">2021-03-04</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/flink/">flink</a></span></div><div class="content">Checkpoint简介Flink定期保存数据，failover后从上次成功的保存点处恢复，并提供Exactly-Once的投递保障机制
CheckpointCoordinator123456789101112131415161718192021222324252627282930313233// 恢复保存点public boolean restoreSavepoint(        String savepointPointer,        boolean allowNonRestored,        Map&lt;JobVertexID, ExecutionJobVertex&gt; tasks,        ClassLoader userClassLoader) throws Exception &#123;    Preconditions.checkNotNull(savepointPointer, &quot;The savepoint path cannot be null.&quot;);    LOG.info(&quot;Starting job &# ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/02/21/Flink%E6%96%B9%E6%A1%88%E8%AE%B0%E5%BD%95/" title="Flink方案记录">     <img class="post_bg" src="/img/topimg/202105161042.png" onerror="this.onerror=null;this.src='/img/404-b.jpg'" alt="Flink方案记录"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/02/21/Flink%E6%96%B9%E6%A1%88%E8%AE%B0%E5%BD%95/" title="Flink方案记录">Flink方案记录</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-02-21T00:31:57.000Z" title="发表于 2021-02-21 08:31:57">2021-02-21</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/flink/">flink</a></span></div><div class="content">flink 快慢流双流join
1、自定义UDF函数，join不到sleep一下
2、在join operator处数据等一会再查
3、如果没有join到,把数据重新回流,等再次消费后再次join
4、如果source端的MQ支持延迟消息，直接使用MQ的延迟功能(例如kafka的时间轮)
5、扩展Flink Source,例如在Kafka Connector中加入time.wait属性,当用户设置这个属性就让source的数据等一会
6、对于未匹配上的数据可以先导入外部存储,后续进行匹配  
7、如果source端是kafka,数据在写入kafka时候设置key（后续的join key）的值,使得同key的数据延迟度降低

flink 作业迁移注意事项flink对接kafka, kafka offset如何保证?背景:kafka与yarn集群同时迁移到新集群,保证flink作业不丢数据。使用kafka mirror,从原有kafka集群copy数据到新集群,flink作业做savepoint,地址是新集群地址,在新的yarn集群上启动flink作业。注意:必要时可以使用state pr ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2021/02/20/Flink%20Graph/" title="Flink Graph">     <img class="post_bg" src="/img/topimg/202105161043.png" onerror="this.onerror=null;this.src='/img/404-b.jpg'" alt="Flink Graph"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/02/20/Flink%20Graph/" title="Flink Graph">Flink Graph</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-02-20T00:31:57.000Z" title="发表于 2021-02-20 08:31:57">2021-02-20</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/flink/">flink</a></span></div><div class="content">StreamGraph是通过用户的Stream API编写的代码生成最初的图，用来表示程序的拓扑结构

StreamNode：用来代表operator的类，并具有所有相关的属性，如并发度、入边和出边等。
StreamEdge：表示连接两个StreamNode的边。

JobGraphStreamGraph经过优化后生成JobGraph，提交给JobManager数据结构。主要是将多个符合条件的节点chain在一起作为一个节点，这样可以减少数据在节点之间流动所需的序列化/反序列化/传输消耗。

JobVertex：经过优化后符合条件的多个StreamNode可能会chain在一起生成一个JobVertex，即一个JobVertex包含一个或多个operator，JobVertex的输入是JobEdge，输出是IntermediateDataSet。
IntermediateDataSet：表示JobVertex的输出，即经过operator处理产生的数据集。producer是JobVertex，consumer是JobEdge。
JobEdge：代表了job graph中的一条数据传输通 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/02/05/%E9%A2%84%E6%B5%8B%E7%AE%97%E6%B3%95/" title="预测算法">     <img class="post_bg" src="/img/topimg/202105161044.png" onerror="this.onerror=null;this.src='/img/404-b.jpg'" alt="预测算法"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/02/05/%E9%A2%84%E6%B5%8B%E7%AE%97%E6%B3%95/" title="预测算法">预测算法</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-02-05T00:31:57.000Z" title="发表于 2021-02-05 08:31:57">2021-02-05</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/python/">python</a></span></div><div class="content">环境安装conda1234567891011121314151617181920# 安装的模块conda list# 创建指不定版本的环境conda create -n pEvn3_7 python=3.7# 环境激活脚本source activate pEvn3_7# 安装模块conda install -n pEvn3_7 [package]# 退出环境source deactivate# 安装tensorflowpip install tensorflow==1.15# 卸载tensorflowpip uninstall tensorflow
prophet1conda install -c conda-forge fbprophet

算法库statsmodels
算法示例指数平滑算法
</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2021/01/06/Expand%20Flink%20Sql/" title="Expand Flink Sql">     <img class="post_bg" src="/img/topimg/202105161045.png" onerror="this.onerror=null;this.src='/img/404-b.jpg'" alt="Expand Flink Sql"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/01/06/Expand%20Flink%20Sql/" title="Expand Flink Sql">Expand Flink Sql</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-01-06T00:31:57.000Z" title="发表于 2021-01-06 08:31:57">2021-01-06</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/flink/">flink</a></span></div><div class="content">扩展format
输入数据格式
12ANALYSIS,2020-08-06 17:20:24.066,2,&#123;&quot;condition&quot;:&#123;&quot;mail&quot;:&quot;zhangsan@qq.com&quot;,&quot;guid&quot;:&quot;1111111&quot;,&quot;request_id&quot;:&quot;b1ca18645f03e01abfd9bcfe5b2e0f3a&quot;,&quot;status&quot;:&quot;200&quot;&#125;,&quot;entityMata&quot;:&#123;&quot;ipAddress&quot;:&quot;0.0.0.0&quot;,&quot;logValue&quot;:2.0,&quot;metric&quot;:&quot;metric1&quot;,&quot;service&quot;:&quot;service1&quot;&#125;,&quot;traceId&quot;:&quot;385307967614d7 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/12/24/Flink%20Retraction%20Mechanism/" title="Flink Retraction">     <img class="post_bg" src="/img/topimg/202105161046.png" onerror="this.onerror=null;this.src='/img/404-b.jpg'" alt="Flink Retraction"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/24/Flink%20Retraction%20Mechanism/" title="Flink Retraction">Flink Retraction</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-24T00:31:57.000Z" title="发表于 2020-12-24 08:31:57">2020-12-24</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/flink/">flink</a></span></div><div class="content">Flink Retraction MechanismFlink Sql最终生成Physical Planning后会对每个RelNode打标,判断当前RelNode是哪种ChangelogMode
FlinkChangelogModeInferenceProgram
12345678910111213141516171819202122232425262728293031323334353637383940414243444546override def optimize(    root: RelNode,    context: StreamOptimizeContext): RelNode = &#123;  // step1: 确定每个节点的变更类型  // 先从source节点开始标记节点属于哪种 ModifyKindSetTrait(I,U,D,Empty)  val physicalRoot = root.asInstanceOf[StreamPhysicalRel]  val rootWithModifyKindSet = SATISFY_MODIFY_KIND_SET ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/12/23/Flink%20Sql%20SMJ/" title="Flink Sql SMJ">     <img class="post_bg" src="/img/topimg/202105161047.png" onerror="this.onerror=null;this.src='/img/404-b.jpg'" alt="Flink Sql SMJ"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/23/Flink%20Sql%20SMJ/" title="Flink Sql SMJ">Flink Sql SMJ</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-23T00:31:57.000Z" title="发表于 2020-12-23 08:31:57">2020-12-23</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/sql/">sql</a></span></div><div class="content">Sort Merge Join简介
1.In most cases, its performance is weaker than HashJoin.


2.It is more stable than HashJoin, and most of the data can be sorted stably.


3.SortMergeJoin should be the best choice if sort can be omitted in the case of multi-level join cascade with the same key.

Join流程除了sort、spill、merge，join流程大致与spark类似
源码BinaryExternalSorter分别包含3个异步线程(sort, spill, merger)，三个线程通过circularQueues实现通信

SortingThread
123456789101112131415161718192021222324252627282930313233343536373839404142434445 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/11/22/Flink%20Window/" title="Flink window">     <img class="post_bg" src="/img/topimg/202105161048.png" onerror="this.onerror=null;this.src='/img/404-b.jpg'" alt="Flink window"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/11/22/Flink%20Window/" title="Flink window">Flink window</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-11-22T00:31:57.000Z" title="发表于 2020-11-22 08:31:57">2020-11-22</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/flink/">flink</a></span></div><div class="content">Flink WindowKeyed Windows
123456789stream      .key(...)      .window(...)      [.trigger(...)]      [.evictor(...)]      [.allowedLateness(...)]      [.sideOutputLateData(...)]      .reduce/aggregate/fold/apply()      [.getSideOutput(...)]
No-Keyed Windows
12345678stream      .windowAll(...)      [.trigger(...)]      [.evictor(...)]      [.allowedLateness(...)]      [.sideOutputLateData(...)]      .reduce/aggregate/fold/apply()      [.getSideOutput(...)]

Evictor可以在执行window trigger之前或之后对window中 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/11/19/GC/" title="GC">     <img class="post_bg" src="/img/topimg/202105161049.png" onerror="this.onerror=null;this.src='/img/404-b.jpg'" alt="GC"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/11/19/GC/" title="GC">GC</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-11-19T00:31:57.000Z" title="发表于 2020-11-19 08:31:57">2020-11-19</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java/">java</a></span></div><div class="content">GC 算法重点关注的GC case1、**System.gc()**： 手动触发GC操作。
2、CMS： CMS GC 在执行过程中的一些动作，重点关注 CMS Initial Mark 和 CMS Final Remark 两个 STW 阶段
3、Promotion Failure： Old 区没有足够的空间分配给 Young 区晋升的对象（即使总可用内存足够大）
4、Concurrent Mode Failure： CMS GC 运行期间，Old 区预留的空间不足以分配给新的对象，此时收集器会发生退化，严重影响 GC 性能，下面的一个案例即为这种场景
5、GCLocker Initiated GC： 如果线程执行在 JNI 临界区时，刚好需要进行 GC，此时 GC Locker 将会阻止 GC 的发生，同时阻止其他线程进入 JNI 临界区，直到最后一个线程退出临界区时触发一次 GC
GC 问题分类：Unexpected GC： 意外发生的 GC，实际上不需要发生，我们可以通过一些手段去避免

Space Shock： 空间震荡问题，参见“场景一：动态扩容引起的空间震荡”  现象：服 ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/2/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/#content-inner">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/#content-inner">4</a><a class="extend next" rel="next" href="/page/4/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/shanyi.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Asura7969</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">38</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Asura7969"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Asura7969" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1402357969@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/12/09/Flink%201.16.0%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/" title="Flink 1.16.0源码编译"><img src="/img/topimg/202106050953.png" onerror="this.onerror=null;this.src='/img/404-b.jpg'" alt="Flink 1.16.0源码编译"/></a><div class="content"><a class="title" href="/2022/12/09/Flink%201.16.0%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91/" title="Flink 1.16.0源码编译">Flink 1.16.0源码编译</a><time datetime="2022-12-09T14:17:57.000Z" title="发表于 2022-12-09 22:17:57">2022-12-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/15/Rust-NoteBook/" title="Rust-NoteBook"><img src="/img/topimg/rust.png" onerror="this.onerror=null;this.src='/img/404-b.jpg'" alt="Rust-NoteBook"/></a><div class="content"><a class="title" href="/2022/11/15/Rust-NoteBook/" title="Rust-NoteBook">Rust-NoteBook</a><time datetime="2022-11-15T12:24:45.000Z" title="发表于 2022-11-15 20:24:45">2022-11-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/10/13/Deltalake-CDF-CDC/" title="Deltalake CDF &amp; CDC"><img src="/img/topimg/16.png" onerror="this.onerror=null;this.src='/img/404-b.jpg'" alt="Deltalake CDF &amp; CDC"/></a><div class="content"><a class="title" href="/2022/10/13/Deltalake-CDF-CDC/" title="Deltalake CDF &amp; CDC">Deltalake CDF &amp; CDC</a><time datetime="2022-10-13T12:54:35.000Z" title="发表于 2022-10-13 20:54:35">2022-10-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/02/17/kafka%E5%8D%87%E7%BA%A7-Security/" title="kafka升级-Security"><img src="/img/topimg/202202172112.png" onerror="this.onerror=null;this.src='/img/404-b.jpg'" alt="kafka升级-Security"/></a><div class="content"><a class="title" href="/2022/02/17/kafka%E5%8D%87%E7%BA%A7-Security/" title="kafka升级-Security">kafka升级-Security</a><time datetime="2022-02-17T13:11:12.000Z" title="发表于 2022-02-17 21:11:12">2022-02-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/02/17/kafka-SCRAM-ACL%E9%85%8D%E7%BD%AE/" title="kafka &amp;&amp; SCRAM + ACL配置"><img src="/img/topimg/202111111633.png" onerror="this.onerror=null;this.src='/img/404-b.jpg'" alt="kafka &amp;&amp; SCRAM + ACL配置"/></a><div class="content"><a class="title" href="/2022/02/17/kafka-SCRAM-ACL%E9%85%8D%E7%BD%AE/" title="kafka &amp;&amp; SCRAM + ACL配置">kafka &amp;&amp; SCRAM + ACL配置</a><time datetime="2022-02-17T13:04:36.000Z" title="发表于 2022-02-17 21:04:36">2022-02-17</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/flink/"><span class="card-category-list-name">flink</span><span class="card-category-list-count">11</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/java/"><span class="card-category-list-name">java</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/kafka/"><span class="card-category-list-name">kafka</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/python/"><span class="card-category-list-name">python</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/rpc/"><span class="card-category-list-name">rpc</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/rust/"><span class="card-category-list-name">rust</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/shuffle/"><span class="card-category-list-name">shuffle</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/spark/"><span class="card-category-list-name">spark</span><span class="card-category-list-count">4</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/Rust/" style="font-size: 1.1em; color: #999">Rust</a> <a href="/tags/delta/" style="font-size: 1.1em; color: #999">delta</a> <a href="/tags/flink/" style="font-size: 1.5em; color: #99a9bf">flink</a> <a href="/tags/java/" style="font-size: 1.1em; color: #999">java</a> <a href="/tags/kafka/" style="font-size: 1.23em; color: #999ea6">kafka</a> <a href="/tags/python/" style="font-size: 1.1em; color: #999">python</a> <a href="/tags/spark/" style="font-size: 1.37em; color: #99a4b2">spark</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/12/"><span class="card-archive-list-date">十二月 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/11/"><span class="card-archive-list-date">十一月 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/10/"><span class="card-archive-list-date">十月 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/02/"><span class="card-archive-list-date">二月 2022</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/09/"><span class="card-archive-list-date">九月 2021</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/08/"><span class="card-archive-list-date">八月 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/06/"><span class="card-archive-list-date">六月 2021</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/05/"><span class="card-archive-list-date">五月 2021</span><span class="card-archive-list-count">1</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">38</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2022-12-09T16:14:58.047Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Asura7969</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>